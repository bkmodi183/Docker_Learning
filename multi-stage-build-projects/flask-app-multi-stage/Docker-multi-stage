# Stage 1 (Where we have a slim image of Linux Distribution)

FROM python:3.9-slim AS builder
WORKDIR /app
COPY . .
RUN pip install -r requirements.txt --target=/app/dependencies

# Stage 2 (Where we will be have just the application code and the code dependencies without linux distribution)

FROM gcr.io/distroless/python3-debian12
WORKDIR /app

COPY --from=builder /app/dependencies /app/dependencies
COPY --from=builder /app .

ENV PYTHONPATH="/app/dependencies/"
EXPOSE 80
CMD ["run.py"]
