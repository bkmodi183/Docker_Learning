------------------------------------------------------------------------------------------------------------------------------ 
                                          Two Tier Flask App Hands on
------------------------------------------------------------------------------------------------------------------------------ 

Hands-on Exercise: Docker Networking with a Two-Tier Flask Application
Objective: Learn Docker networking and persistent storage with Flask + MySQL

------------------------------------------------------------------------------------------------------------------------------ 
Step 1: Create Docker network
docker network create twotier  # Create a network for the Flask app and MySQL to communicate
------------------------------------------------------------------------------------------------------------------------------ 
Step 2: Create Docker volume for MySQL persistence
docker volume create mysql-data  # Persistent volume for MySQL data
------------------------------------------------------------------------------------------------------------------------------ 
Step 3: Run MySQL container
docker run -d -v mysql-data:/var/lib/mysql -p 3306:3306 --network=twotier -e MYSQL_USER=admin -e MYSQL_PASSWORD=admin 
-e MYSQL_DATABASE=bk_db -e MYSQL_ROOT_PASSWORD=root --name mysql mysql:5.7  # MySQL container with persistent volume
------------------------------------------------------------------------------------------------------------------------------ 
Step 4: Build Flask app Docker image
docker build -t flask-app:latest .  # Build Flask Docker image from current directory
------------------------------------------------------------------------------------------------------------------------------ 
Step 5: Run Flask app container
docker run -d --network=twotier -e MYSQL_HOST=mysql -e MYSQL_USER=admin -e MYSQL_PASSWORD=admin -e MYSQL_DB=bk_db 
-p 5000:5000 --name flask-app-ctr flask-app:latest  # Run Flask app connected to MySQL
------------------------------------------------------------------------------------------------------------------------------ 
Step 6: Verify network connectivity
docker inspect network twotier  # Check whether both containers are connected to the 'twotier' network

Conclusion: Both Flask and MySQL containers are communicating via the Docker network
------------------------------------------------------------------------------------------------------------------------------ 
Step 7: Access Flask app
Open port 5000 in EC2 security group, then visit http://<EC2_PUBLIC_IP>:5000 and enter data
------------------------------------------------------------------------------------------------------------------------------ 
Step 8: Verify data inside MySQL
docker exec -it mysql bash  # Access MySQL container shell
mysql -u admin -p  # Login to MySQL (password: admin)
Inside MySQL shell:
- SHOW DATABASES;
- USE bk_db;
- SHOW TABLES;
- SELECT * FROM messages;
------------------------------------------------------------------------------------------------------------------------------ 
Step 9: Test persistence
docker rm -f flask-app-ctr mysql  # Delete both containers
-Re-run Step 3 and Step 5 to restart containers; old data will persist because of the volume
------------------------------------------------------------------------------------------------------------------------------ 
Conclusion:
- Docker network allows Flask and MySQL containers to communicate securely.
- Docker volumes make MySQL data persistent across container restarts and container deletion.
------------------------------------------------------------------------------------------------------------------------------ 
